<dc.Html Badges="SysAdmin" NoCache="true">
	<Meta Name="Title">
		<Tr Locale="eng" Value="Edit Tag" />
	</Meta>

	<dcs.ResourceHelper Find="Locale" Result="MyLocaleResource" />

	<dcs.With Target="$MyLocaleResource">
		<GetLocale Result="MyLocale" />
	</dcs.With>

	<dc.Body>
		<dc.PagePanel>
			<dcf.Form>
				<dcf.Text Label="Alias" Name="Alias" Required="true" placeholder="this is internal and not visible to users, no spaces" Pattern="[\w-]+" Instructions="Alias must be unique to this branch of the tree." />
				<dcf.Text Label="Title" Name="Title" Required="true" />
				<dcf.Text Label="Keywords" Name="Keywords" />
				<dcf.TextArea Label="Description" Name="Description" />

				<dcf.FormButtons>
					<dcf.SubmitButton Label="Accept" />
				</dcf.FormButtons>
			</dcf.Form>
		</dc.PagePanel>
	</dc.Body>

	<Function Name="Load"><![CDATA[
			var page = this;

			page.Store.MyLocale = '{$MyLocale}';
			page.Store.NewTag = null;
	]]></Function>
	<Function Name="LoadRecord" Params="e"><![CDATA[
			var page = this;

			e.AsNew = true;
	]]></Function>
	<Function Name="SaveRecord" Params="e"><![CDATA[
			var page = this;

			page.Store.NewTag = {
        Alias: e.Data.Alias,
        Locale: { }
      };

			var locale = page.Store.NewTag.Locale[page.Store.MyLocale] = { };

			locale.Title = e.Data.Title;

			if (e.Data.hasOwnProperty('Keywords'))
				locale.Keywords = e.Data.Keywords;

			if (e.Data.hasOwnProperty('Description'))
				locale.Description = e.Data.Description;
	]]></Function>
	<Function Name="AfterSave"><![CDATA[
			var page = this;

			page.Layer.back();

			if (page.Params.Callback)
				page.Params.Callback(page.Store.NewTag);
	]]></Function>
</dc.Html>
