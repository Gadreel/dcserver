<dc.Html Badges="Admin,Editor">
	<Meta Name="Title"> 
		<Tr Locale="en" Value="Text Widget Properties" />
	</Meta>
	
	<dc.Body>
		<dc.PagePanel>
			<dcf.Form>
				<dcf.FormButtons>
					<dcf.SubmitButton Label="Save" />
				</dcf.FormButtons>
				
				<dcf.Text Name="Class" Label="CSS Classes" placeholder="custom styling for this section" />
				<dcf.HorizRadioGroup Label="Mode" Name="Mode" Required="true">
				   <RadioButton Value="Safe" Label="Safe" />
				   <RadioButton Value="Unsafe" Label="Unsafe" />
				</dcf.HorizRadioGroup>
			</dcf.Form>
		</dc.PagePanel>
	</dc.Body>
	<Function Name="Load"><![CDATA[
			var entry = this;
			
			entry.Store.Params = dc.pui.App.Context.Params;
    ]]></Function>
	<Function Name="LoadRecord" Params="e"><![CDATA[
			var entry = this;
	    
			e.Message = { 
				Service: 'dcCoreServices',
				Feature: 'Vaults',
				Op: 'Custom',
				Body: { 
					Vault: 'Feeds',
					Command: 'LoadPart',
					Path: '/' + entry.Store.Params.Feed + entry.Store.Params.Path, 
					Params: { 
						PartId: entry.Store.Params.Id 
					}
				}
			};
    ]]></Function>
	<Function Name="AfterLoadRecord" Params="e"><![CDATA[
			var entry = this;
			
			var widget = entry.Store.Params.Widget = e.Data.Extra;
			
			var attrs = entry.Store.Params.Content = widget.attributes;
			
			if (! attrs)
				attrs = { };
			
			e.Data = {
				Class: attrs.class ? attrs.class : '',
				Mode: attrs.Mode ? attrs.Mode : 'Safe'
			};
	]]></Function>
	<Function Name="SaveRecord" Params="e"><![CDATA[
			var entry = this;
			
			var widget = entry.Store.Params.Widget;
			
			if (! widget.attributes)
				widget.attributes = { };
			
			if (e.Data.hasOwnProperty('Class'))
				widget.attributes['class'] = e.Data.Class;
			
			if (e.Data.hasOwnProperty('Mode'))
				widget.attributes['Mode'] = e.Data.Mode;
			
			e.Message = { 
				Service: 'dcCoreServices',
				Feature: 'Vaults',
				Op: 'Custom',
				Body: { 
					Vault: 'Feeds',
					Command: 'SavePart',
					Path: '/' + entry.Store.Params.Feed + entry.Store.Params.Path, 
					Params: { 
						PartId: entry.Store.Params.Id,
						Part: widget
					}
				}
			};					
    ]]></Function>
	<Function Name="AfterSave"><![CDATA[
			dc.pui.Popup.alert('Saved');
	]]></Function>
</dc.Html>