<dc.Html Badges="SysAdmin" NoCache="true">
	<Meta Name="Title">
		<Tr Locale="eng" Value="Edit Tag" />
	</Meta>

	<dcs.ResourceHelper Find="Locale" Result="MyLocaleResource" />
	<dcs.ResourceHelper Level="Site" Find="Locale" Result="SiteLocaleResource" />

	<dcs.With Target="$MyLocaleResource">
		<GetLocale Result="MyLocale" />
	</dcs.With>

	<dcs.With Target="$SiteLocaleResource">
		<GetLocale Result="SiteLocale" />
	</dcs.With>

	<dc.Body>
		<dc.PagePanel>
			<dcf.Form>
				<dcf.Text Label="Title" Name="Title" Required="true" />
				<dcf.Text Label="Ref Title" Name="RefTitle" readonly="readonly" />
				<dcf.Text Label="Keywords" Name="Keywords" />
				<dcf.Text Label="Ref Keywords" Name="RefKeywords" readonly="readonly" />
				<dcf.TextArea Label="Description" Name="Description" />
				<dcf.TextArea Label="Ref Description" Name="RefDescription" readonly="readonly" />

				<dcf.FormButtons>
					<dcf.SubmitButton Label="Accept" />
				</dcf.FormButtons>
			</dcf.Form>
		</dc.PagePanel>
	</dc.Body>

	<Function Name="Load"><![CDATA[
			var page = this;

			page.Store.MyLocale = '{$MyLocale}';
			page.Store.SiteLocale = '{$SiteLocale}';

			if (! page.Params.Tag.Locale[page.Store.MyLocale])
				page.Params.Tag.Locale[page.Store.MyLocale] = { };

			if (! page.Params.Tag.Locale[page.Store.SiteLocale])
				page.Params.Tag.Locale[page.Store.SiteLocale] = { };
	]]></Function>
	<Function Name="LoadRecord" Params="e"><![CDATA[
			var page = this;

			e.Data = page.Params.Tag.Locale[page.Store.MyLocale];

			var sitedata = page.Params.Tag.Locale[page.Store.SiteLocale];

			if (sitedata.Title)
				e.Data.RefTitle = sitedata.Title;

			if (sitedata.Keywords)
				e.Data.RefKeywords = sitedata.Keywords;

			if (sitedata.Description)
				e.Data.RefDescription = sitedata.Description;
	]]></Function>
	<Function Name="SaveRecord" Params="e"><![CDATA[
			var page = this;

			var locale = page.Params.Tag.Locale[page.Store.MyLocale];

			if (e.Data.hasOwnProperty('Title'))
				locale.Title = e.Data.Title;

			if (e.Data.hasOwnProperty('Keywords'))
				locale.Keywords = e.Data.Keywords;

			if (e.Data.hasOwnProperty('Description'))
				locale.Description = e.Data.Description;
	]]></Function>
	<Function Name="AfterSave"><![CDATA[
			var page = this;

			page.Layer.back();

			if (page.Params.Callback)
				page.Params.Callback(page.Params.Tag.Locale[page.Store.MyLocale]);
	]]></Function>
</dc.Html>
